# واجهات برمجية مقترحة لتطبيق الإدارة في ConnectChain

لتطوير تطبيق الإدارة في مشروع ConnectChain، ستحتاج إلى تنفيذ مجموعة من واجهات برمجية التطبيقات (APIs) باستخدام Node.js وExpress، مع الاتصال بقاعدة بيانات MSSQL موجودة باستخدام Prisma. ستمكنك هذه الواجهات من إدارة العملاء (أصحاب متاجر البيع المباشر)، الموردين (تجار الجملة)، فئات المنتجات، الطلبات، وتوفير تحليلات في لوحة التحكم. فيما يلي قائمة شاملة بالواجهات البرمجية المقترحة، مقسمة حسب الوظيفة، مع وصف لكل واجهة والبيانات المتوقعة.

## إدارة العملاء
تتيح هذه الواجهات إدارة حسابات العملاء، بما في ذلك عرض البيانات، تحديثها، وحظر أو إلغاء حظر المستخدمين.

| الواجهة | الطريقة | الوصف | معلمات الاستعلام | البيانات المرتجعة |
|----------|---------|-------|-------------------|-------------------|
| `/customers` | GET | استرجاع قائمة بجميع العملاء مع التصفح | `page`, `limit` | قائمة العملاء (الاسم، البريد الإلكتروني، الحالة، إلخ) |
| `/customers/:id` | GET | استرجاع تفاصيل عميل معين | - | بيانات العميل (الاسم، البريد الإلكتروني، العنوان، إلخ) |
| `/customers/:id/orders` | GET | استرجاع طلبات عميل معين | `page`, `limit` | قائمة الطلبات (رقم الطلب، التاريخ، المبلغ، إلخ) |
| `/customers/:id` | PATCH | تحديث بيانات العميل || - | رسالة تأكيد التحديث |
| `/customers/:id/ban` | PATCH | حظر عميل | - | رسالة تأكيد الحظر |
| `/customers/:id/unban` | PATCH | إلغاء حظر عميل | - | رسالة تأكيد إلغاء الحظر |

## إدارة الموردين
تتيح هذه الواجهات إدارة الموردين، بما في ذلك التحقق من طلبات الانضمام، عرض المنتجات والطلبات، وحظر أو إلغاء حظر الموردين.

| الواجهة | الطريقة | الوصف | معلمات الاستعلام | البيانات المرتجعة |
|----------|---------|-------|-------------------|-------------------|
| `/suppliers` | GET | استرجاع قائمة بجميع الموردين مع التصفح | `page`, `limit` | قائمة الموردين (الاسم، بيانات الشركة، الحالة) |
| `/suppliers/:id` | GET | استرجاع تفاصيل مورد معين | - | بيانات المورد (الاسم، العنوان، المستندات، إلخ) |
| `/suppliers/:id/products` | GET | استرجاع منتجات مورد معين | `page`, `limit` | قائمة المنتجات (الاسم، السعر، المخزون، إلخ) |
| `/suppliers/:id/orders` | GET | استرجاع طلبات مورد معين | `page`, `limit` | قائمة الطلبات (رقم الطلب، العميل، المبلغ، إلخ) |
| `/suppliers/:id/accept` | PATCH | قبول طلب المورد | - | رسالة تأكيد القبول |
| `/suppliers/:id/reject` | PATCH | رفض طلب المورد | `reason` | رسالة تأكيد الرفض مع السبب |
| `/suppliers/:id/ban` | PATCH | حظر مورد | - | رسالة تأكيد الحظر |
| `/suppliers/:id/unban` | PATCH | إلغاء حظر مورد | - | رسالة تأكيد إلغاء الحظر |

## إدارة الفئات
تتيح هذه الواجهات إنشاء وتحديث وحذف فئات المنتجات المستخدمة في تطبيق العملاء.

| الواجهة | الطريقة | الوصف | معلمات الاستعلام | البيانات المرتجعة |
|----------|---------|-------|-------------------|-------------------|
| `/categories` | GET | استرجاع قائمة بجميع الفئات | - | قائمة الفئات (الاسم، الوصف، الفئة الأم) |
| `/categories` | POST | إنشاء فئة جديدة | - | بيانات الفئة الجديدة |
| `/categories/:id` | PATCH | تحديث فئة موجودة | - | رسالة تأكيد التحديث |
| `/categories/:id` | DELETE | حذف فئة | - | رسالة تأكيد الحذف |

## إدارة الطلبات
تتيح هذه الواجهات عرض الطلبات وتحديث حالتها، بما في ذلك رفض الطلبات إذا لزم الأمر.

| الواجهة | الطريقة | الوصف | معلمات الاستعلام | البيانات المرتجعة |
|----------|---------|-------|-------------------|-------------------|
| `/orders` | GET | استرجاع قائمة بجميع الطلبات مع التصفح | `page`, `limit` | قائمة الطلبات (رقم الطلب، العميل، المورد، الحالة) |
| `/orders/:id` | GET | استرجاع تفاصيل طلب معين | - | بيانات الطلب (التاريخ، المبلغ، العناصر، إلخ) |
| `/orders/:id/status` | PATCH | تحديث حالة الطلب | `status` | رسالة تأكيد التحديث |

## إدارة المنتجات (اختياري)
إذا كان الإداريون بحاجة إلى الإشراف على المنتجات، يمكن تنفيذ هذه الواجهات.

| الواجهة | الطريقة | الوصف | معلمات الاستعلام | البيانات المرتجعة |
|----------|---------|-------|-------------------|-------------------|
| `/products` | GET | استرجاع قائمة بجميع المنتجات مع التصفح | `page`, `limit` | قائمة المنتجات (الاسم، السعر، المورد، إلخ) |
| `/products/:id` | GET | استرجاع تفاصيل منتج معين | - | بيانات المنتج (الوصف، المخزون، إلخ) |
| `/products/:id` | DELETE | حذف منتج | - | رسالة تأكيد الحذف |

## لوحة التحكم
توفر هذه الواجهة بيانات تحليلية لعرضها في لوحة التحكم.

| الواجهة | الطريقة | الوصف | معلمات الاستعلام | البيانات المرتجعة |
|----------|---------|-------|-------------------|-------------------|
| `/dashboard` | GET | استرجاع بيانات التحليلات | - | كائن JSON يحتوي على التحليلات |

**مثال على البيانات المرتجعة من `/dashboard`**:
```json
{
  "totalCustomers": 100,
  "totalSuppliers": 50,
  "pendingSuppliers": 5,
  "totalOrders": 200,
  "totalRevenue": 10000,
  "ordersByStatus": {
    "pending": 20,
    "processing": 50,
    "shipped": 100,
    "rejected": 30
  },
  "topProducts": [
    {"id": 1, "name": "منتج أ", "sales": 100},
    {"id": 2, "name": "منتج ب", "sales": 80}
  ],
  "recentOrders": [
    {"id": 101, "customer": "عميل 1", "total": 500, "date": "2025-04-24"},
    {"id": 102, "customer": "عميل 2", "total": 300, "date": "2025-04-24"}
  ]
}
```

## ملاحظات تنفيذ
- **المصادقة والتفويض**: قم بتنفيذ آليات أمان مثل رموز JWT لحماية الواجهات البرمجية.
- **التصفح**: استخدم معلمات `page` و`limit` لتحسين الأداء عند استرجاع قوائم طويلة.
- **إدارة الطلبات**: نظرًا لأن الطلبات تُوضع تلقائيًا عند توفر المخزون، تأكد من أن واجهة تحديث حالة الطلب تتيح للإداري رفض الطلبات يدويًا مع حالات مثل "مرفوض" أو "قيد المعالجة".
- **التحقق من الموردين**: قم بتضمين حقول في نموذج المورد لتخزين بيانات الشركة (مثل الاسم، العنوان، المستندات) وحالة التحقق (معلق، مقبول، مرفوض).
- **التعامل مع الأخطاء**: قم بتنفيذ معالجة الأخطاء للتعامل مع الحالات مثل معرفات غير موجودة أو بيانات غير صالحة.

## ميزات إضافية مقترحة
لتوفير تحكم كامل في النظام، يمكنك التفكير في الميزات التالية:
- **إشعارات الإداري**: إعلام الإداري عند وجود طلبات موردين معلقة أو طلبات تحتاج إلى مراجعة.
- **إدارة الأدوار**: إذا كان هناك عدة إداريين، قم بتنفيذ نظام أدوار وأذونات.
- **تقارير متقدمة**: إضافة تقارير تحليلية إضافية مثل المبيعات على مدى 30 يومًا أو أفضل العملاء بناءً على قيمة الطلب.
- **مراقبة المخزون**: السماح للإداري بعرض مستويات المخزون لكل مورد لتحديد المنتجات منخفضة المخزون.

## الاعتبارات الخاصة بـ B2B
نظرًا لأن ConnectChain منصة B2B، قد ترغب في التفكير في ميزات إضافية خاصة بـ B2B مثل:
- **حسابات الشركات**: إذا كان العملاء أو الموردون يمثلون شركات مع عدة مستخدمين، يمكنك إضافة دعم لحسابات الشركات مع أدوار وأذونات.
- **إدارة التسعير**: السماح للإداري بمراجعة أو تعديل هياكل التسعير التي يحددها الموردون.
- **إدارة عروض الأسعار**: إذا كان العملاء يطلبون عروض أسعار للطلبات الكبيرة، يمكنك إضافة واجهات برمجية لإدارة طلبات عروض الأسعار.

ومع ذلك، نظرًا لأن هذا مشروع تخرج، فإن الواجهات البرمجية المذكورة أعلاه توفر أساسًا قويًا مع الحفاظ على نطاق يمكن إدارته.